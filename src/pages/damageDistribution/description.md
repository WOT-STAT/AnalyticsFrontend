## Описание

График расширенного распределения урона строится **исключительно для одного типа урона**, поскольку в игре урон принимает только целочисленные значения. Это приводит к тому, что при нормализации различные уровни урона распределяются неравномерно.

#### Например для урона в 11 единиц
- 11 - 25% = 8
- 11 + 25% = 14

То есть любой урон из `[8, 9, 10, 11, 12, 13, 14]`, или же `[-3, -2, -1, 0, +1, +2, +3]` относительно базового.
Однако при нормализации, получаем `[-27%, -18%, -9%, 0%, +9%, +18%, +27%]` относительно базового урона. 
Смешивание этих значений с графиком для других значений урона, например, 390, приведет к возникновению пиков на уровнях `-27%`, `-18%` и так далее, что может сбивать с толку.

Поэтому для каждого значения урона строится индивидуальный график распределения

### Граничные значения

График строится из центра, таким образом, чтоб базовый урон располагался ровно по центру. По этой же причине, возможны только нечётное число значений урона на столбик. 

Из-за особенностей округления крайних значений урона иногда возникают некратные интервалы. В таких случаях, крайний левый и крайний правый столбики могут содержать разное число значений урона. Если вы хотите оценить минимальный и максимальный урон, выбирайте шаг графика равный 1

#### Например для урона в 390 единиц и 7 значений на столбик
- 390 - 25% = 292.5 => 293 (минимальное значение в игре)
- 390 + 25% = 487.5 => 488 (максимальное значение в игре)

Следовательно, слева от базового урона в 390 будут **97** возможных значений урона, а справа — **98**. Построение симметричного графика в таком случае невозможно, по этому центральный столбик будет состоять из `[387, 388, 389, 390, 391, 392, 393]`, крайний левый столбик из `[293, 294, 295]`, а крайний правый из `[485, 486, 487, 488]`

#### Для урона в 360 единиц
- 360 - 25% = 270
- 360 + 25% = 450

Диапазон [270; 450] содержит 181 значение, **90** слева от среднего и **90** справа, что позволяет построить полноценный график. При распределении урона по столбцам с шагом в 5 значений на столбец, получается 35 столбцов по 5 значений и два крайних столбца по 3 значения в каждом.

Этот промежуток уже кратный, поэтому график строится для промежутка `[270, 271, ..., 449, 450]`. Однако при шаге в **5** видов урона на столбик, получаем 35 центральных столбика по **5** видов урона в каждом, и два крайних столбика по **3** видов урона в каждом. 

Это следует учитывать, поскольку крайние столбцы могут содержать меньше значений, чем основные.

## Расчёт погрешности
Погрешность графика зависит от:
- базового урона (тк влияет округление до целых)
- количества выстрелов с уроном
- числа уронов на столбик

Для каждой комбинации этих параметров, погрешность рассчитывается индивидуально 

### Для расчёта погрешности:
1. Генерируются **N** (=вашему числу выстрелов) случайных значений стандартным генератором случайных чисел `math.random()` в `JavaScript`
2. Равномерное распределение от 0 до 1 преобразуется в танковое распределение урона (похожее на Гауссово) от -1 до +1 

*С помощью сплайн интерполяции по 100 значениям к функции численно обратной функции распределения урона (CDF) для канонического нормального распределения с коэффициентами `a = 0.02399886787`, `b = -0.006796346129`, `c = 0.4711312389` в формуле `a*exp(-((x-b)/c)^2)`*

3. Результат умножается на 0.25, к нему прибавляется 1, и это все умножается на базовый урон, после чего результат округляется до ближайшего целого.
4. Полученное значение записывается соответствующий столбик графика
5. Алгоритм повторяется **X** раз, где **X** - количество экспериментов для расчёта погрешности (настраивается перед расчётом)
6. Результаты каждого столбика сортируются по возрастанию

`DMG = round((invCDF(RND) * 0.25 + 1) * BASE_DMG)` - формула для расчёта урона

### Доверительный интервал

После расчёта погрешности, можно построить доверительный интервал для каждого столбика с указанным **уровнем доверия P**. Для этого у каждого столбика берётся значение снизу и сверху с *1 - уровень доверия* и *уровень доверия* отсечения значений (кавантили). 

На графике появится две линии, обозначающие нижнюю и верхнюю границы доверительного интервала, между которыми располагались **P%** экспериментов из **X** симуляций.


## Карточки инфографики
### Средний урон
Арифметическое среднее всех уронов в базе данных (Сумма делить на количество)

### Медианный урон
Значение урона, разделяющее все значения на две равные части. Если количество значений четное, медиана представляет собой среднее арифметическое двух центральных значений. Это означает, что половина значений урона меньше медианы, а другая половина — больше.

### Выстрелов с уроном ниже среднего
Рассчитывается как процент выстрелов с **уроном ниже среднего** по сравнению с выстрелами с **уроном выше среднего**. Выстрелы с базовым уроном не учитываются. В идеальном распределении этот показатель должен составлять **50%**.